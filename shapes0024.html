<!DOCTYPE html>
<html>
<head>

</head>
<body>
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script>
 
//set up window size
var width = window.innerWidth,
    height = window.innerHeight,

// set variables for proportional display
    smallDim = Math.min(width, height),
    radius = smallDim / 20,
    textHeight = radius * 1.5,
    sizeFactor = smallDim / 900,

// data and coords for 1-1 loop
    nullData11 = ["X", "X", "X", "X"],

    nullCoords11 = [
        [-80, -300],
        [80, -300],
        [-80, 300],
        [80, 300]
    ],

    activeData11 = ["A", "U", "R", "G", "C", "Y"], 

    activeCoords11 = [
        [-80, -140],
        [80, -140],
        [-150, 0],
        [150, 0],
        [-80, 140],
        [80, 140]
    ],

// data and coords for 2-2 loop
    nullData22 = ["X", "X", "X", "X"],

    nullCoords22 = [
        [-80, -350],
        [80, -350],
        [-80, 350],
        [80, 330]
    ],

    activeData22 = ["A", "U", "R", "G", "C", "Y", "A", "N"], 

    activeCoords22 = [
        [-80, -190],
        [80, -190],
        [-190, -80],
        [190, -80],
        [-190, 80],
        [190, 80],
        [-80, 190],
        [80, 190]
    ],

// data and coords for hairpin
    nullDataHP = ["X", "X"],

    nullCoordsHP = [
        [-80, -220],
        [80, -220]
    ],

    activeDataHP = ["A", "U", "R", "G", "C", "Y"], 

    activeCoordsHP = [
        [-80, -60],
        [80, -60],
        [-150, 80],
        [150, 80],
        [-80, 220],
        [80, 220]
    ];

// data and coords for bulge -- needs bulge size of one to six nts -- 
// rough coords only -- needs exact coords --
    nullDataBG = ["X", "X", "X", "X", "X"],

    nullCoordsBG = [
        [-80, -190],
        [80, -190],
        [130, 65],
        [-80, 350],
        [80, 330]
    ],

    activeDataBG = ["A", "U", "R", "G",], 

    activeCoordsBG = [
        [-80, -60],
        [80, -60],
        [-130, 65],
        [0, 190]
    ];



// select the html body, add svg element to body, add group element to svg
var svg = d3.select("body")
	.append("svg")
    	.attr("width", width)
    	.attr("height", height)
	.append("g")

// put origin in center of window
    	.attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

// pass in string of NTs into the function, display them as dots in a circle
function update(displayData, displayClass, displayCoords)  {

    var nucleoArray = [
        {key: "A", values: ["Adenine", "yellow"]}, 
        {key: "U", values: ["Uracil", "blue"]}, 
        {key: "G", values: ["Guanine", "red"]}, 
        {key: "C", values: ["Cytosine","green"]}, 
        {key: "R", values: ["puRine", "orange"]}, 
        {key: "Y", values: ["pYrimidine", "turquoise"]}, 
        {key: "N", values: ["unkNown", "gray"]},
        {key: "X", values: ["X null", "pink"]}
    ];
  
    // draw a dot for each array value
    var circles = svg.selectAll("." + displayClass + "Circle")// select all potential display circles
        .data(displayData) // attach displayData
        .enter()
        .append("circle") // add circles
        .attr("class", displayClass + "Circle") // set class so selectAll can find circles
        .attr("r", radius)
        .attr("cx", function(d, i) {return displayCoords[i][0] * sizeFactor})
        .attr("cy", function(d, i) {return displayCoords[i][1] * sizeFactor})
        .attr("fill", function(d, i) {
            var j = 0;
            for (j = 0; j < nucleoArray.length; j++) {
                if(nucleoArray[j].key == d) {
                    return nucleoArray[j].values[1];
                };
            };
            
        })
        // add gray outline on mouseover
        .on("mouseover", function(){d3.select(this)
            .style("stroke", "gray")
            .style("stroke-width", 4);})
        // remove gray outline when not mouseover
        .on("mouseout", function(){d3.select(this)
            .style("stroke", "gray")
            .style("stroke-width", 0);});

        // click to scroll through options
        //.on("click", //scroll)

    var text = svg.selectAll("." + displayClass + "Text") // select potential text of displayClass
        .data(displayData)
        .enter()
        .append("text") // add empty text elements
        .attr("class", displayClass + "Text") // set class so selectAll can find text elements 
        .text(function(d) {return d}) // add text from
        .attr("x", function(d, i) {return displayCoords[i][0] * sizeFactor}) // position
        .attr("y", function(d, i) {return displayCoords[i][1] * sizeFactor + textHeight / 2.5})
        .attr("text-anchor", "middle")
        .style("font-size", textHeight + "px"); // size
}

//update(nullData11, "null11", nullCoords11);      // draws null NTs above and below 1-1 loop
//update(activeData11, "active11", activeCoords11);// draws circle of 6 NTs for 1-1 loop

//update(nullData22, "null22", nullCoords22);      // draws null NTs above and below 2-2 loop
//update(activeData22, "active22", activeCoords22);// draws circle of 8 NTs for 2-2 loop   

//update(nullDataHP, "nullHP", nullCoordsHP);      // draws null NTs above hairpin
//update(activeDataHP, "activeHP", activeCoordsHP);// draws circle of 6 NTs for hairpin

update(nullDataBG, "nullBG", nullCoordsBG);// draws null NTs above and SW of bulge and 1 in circle
update(activeDataBG, "activeHP", activeCoordsBG);// draws 4 NTs in circle of 5 NTs for bulge

</script>
</body>
</html>